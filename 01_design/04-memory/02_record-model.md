## Memory Record Model

### 1. 目的

本文档定义 **Memory 中允许存在的记录模型（Record Model）**，
用于约束 Memory 的数据形式，防止其退化为无结构、不可审计、不可重用的信息堆积。

Memory 不接受任意形态的数据写入，
所有写入内容必须符合本文档定义的记录类型之一。

---

### 2. 基本原则

#### 2.1 记录优先于文本

Memory 存储的基本单元是 **记录（Record）**，而非自由文本。

- 不允许将“原始信息”以未建模文本直接写入
- 所有信息必须被归类为某种明确的 Record 类型
- Record 必须符合预定义的数据形式约束

---

#### 2.2 原始信息 ≠ 未规范信息

Memory 允许存储原始信息，
但**只允许在结构与语义边界明确的前提下**。

“原始”指事实层级，
不指随意、未约束、不可解析的输入。

---

#### 2.3 摘要不是权威来源

摘要、归纳、压缩结果：

- 属于派生信息
- 依赖特定认知视角
- 不可逆

因此：

> 摘要类信息 **不得作为 Memory 的唯一或权威记录**。

Memory 的权威内容，必须始终是可重新解释的原始记录。

---

### 3. Record 的通用结构约束

所有 Memory Record 必须具备以下基础字段：

- `record_type`
  表示记录类型，用于区分语义类别

- `timestamp`
  记录写入时间，不代表重要性或顺序含义

- `payload`
  该 Record 类型允许的、受约束的数据内容

- `metadata`（可选）
  非语义性辅助信息，如来源、上下文标记等

Record 不允许包含：

- 模型相关表示
- 隐式语义字段
- 不可解释的二进制或向量数据

---

### 4. 允许的 Record 类型（初始集合）

Memory 中 **只允许** 存在以下 Record 类型。

#### 4.1 FactRecord

用于存储稳定、可重复引用的事实信息。

特征：

- 不依赖具体认知任务
- 不随时间频繁变化
- 具有明确语义边界

示例内容：

- 配置项
- 身份信息
- 已确认规则
- 明确成立的结论性事实

FactRecord 一经写入，默认不可被语义性修改。

---

#### 4.2 EventRecord

用于存储已发生事件的客观记录。

特征：

- 描述“发生了什么”
- 不包含对事件意义的判断
- 按时间追加

示例内容：

- 接收到的指令
- 执行的动作
- 外部事件输入
- 操作结果

EventRecord 不允许被覆盖或合并。

---

#### 4.3 StateRecord

用于存储 Agent 的长期状态快照。

特征：

- 表示某一时刻的系统状态
- 用于恢复或延续运行
- 允许被后续 StateRecord 替代

示例内容：

- 当前模式
- 长期任务进度
- 持久标志位

StateRecord 的更新以“新增快照”形式发生，而非就地修改。

---

### 5. 明确禁止的 Record 形态

以下内容不得以任何形式写入 Memory：

- 自由文本 dumping
- embedding、向量、token
- 自动生成摘要
- 相似度、评分、排序结果
- 聚合统计或推断结论
- 模型中间态或缓存数据

任何无法被明确归类为某种 Record 类型的数据，均应被拒绝写入。

---

### 6. 写入拒绝原则

当写入内容不符合 Record Model 要求时：

- Memory 必须拒绝写入
- 不进行隐式转换
- 不尝试自动“修正”数据形态

写入失败是**正确且预期的行为**。

---

### 7. 写入责任归属

Memory 不负责决定“是否应当记住某条信息”。

是否产生 Memory Record，属于一次认知层面的判断，
由 Cognition 在完成推理后显式触发。

Memory Record 的写入遵循以下责任划分：

- **Cognition**

  - 判断信息是否具备长期保留意义
  - 决定写入何种 Record 类型
  - 构造符合 Record Model 的写入候选

- **Memory（及其 Admission 层）**

  - 校验写入内容是否符合 Record Model
  - 校验资源、权限与容量约束
  - 接受或拒绝写入请求，不参与语义判断

Memory 不判断记录是否重复、有价值或重要。
任何写入决策错误，均应被视为 Cognition 的行为结果，而非 Memory 的职责。

### 8. 设计自检规则

在引入新的 Record 类型前，必须回答：

- 该 Record 是否描述事实，而非理解？
- 是否可在无模型条件下被解释？
- 是否不会因模型升级而失效？
- 是否具备长期存在的必要性？

若任一问题无法明确回答，则不应引入该 Record 类型。

---

### 9. 总结性定义

Memory Record Model 的目标不是“记住更多”，
而是**只允许被建模的信息存在**。

Memory 不是记忆的垃圾桶，
而是一个**受限、冷静、可复盘的事实容器**。
