# 行动层

## Agent 行动层（Action / MCP）设计文档

### 1. 设计目标

行动层的目标是**可靠执行**，而不是智能决策。

> 行动层负责将来自认知层的**行动意图**，
> 在行为调制状态与运行时约束下，
> 转换为**可执行、可监控、可反馈的具体操作**。

行动层是 agent 与外部世界发生因果关系的**唯一出口**。

---

### 2. 行动层的职责边界

#### 2.1 行动层**负责**

- 接收结构化行动意图
- 将意图映射为具体工具 / 接口 / 操作
- 执行动作并收集执行结果
- 对失败、异常、部分完成进行状态反馈

#### 2.2 行动层**不负责**

- 决定是否应该行动（属于认知）
- 决定行动策略偏好（属于控制状态）
- 推理或重写行动目标
- 长期保存执行历史（属于记忆）
- 调度与并发管理（属于 Runtime）

> 行动层只回答：**“怎么把这件事做出来”**。

---

### 3. 行动层的输入定义

行动层只接受来自**认知层**的结构化输出，通常包括：

- 行动类型（What）
- 行动目标或参数（With what）
- 前置条件声明（If）
- 期望结果或完成条件（Expect）
- 风险或失败容忍度声明（Optional）

行动层不接受：

- 自然语言指令
- 未经认知结构化的用户输入
- 行为风格或策略描述

---

### 4. MCP（Model / Machine Control Protocol）定位

MCP 被定义为：

> **认知意图与外部系统之间的标准化控制接口层。**

其作用是：

- 抽象不同工具、系统、硬件或服务
- 提供统一的调用、错误、反馈语义
- 屏蔽具体实现差异

MCP 是**行动层的内部规范**，不是智能组件。

---

### 5. 行动执行原则

#### 5.1 幂等与可重试

行动层应尽可能支持：

- 幂等执行
- 明确的成功 / 失败状态
- 可重试或可回滚的操作声明

---

#### 5.2 显式失败优于隐式成功

行动层必须：

- 明确报告失败原因
- 不得静默吞掉异常
- 不得自行“修正目标”

失败是输入给认知层的重要信号。

---

#### 5.3 行动结果不可被解释

行动层返回的是**事实结果**，而不是判断：

- 成功 / 失败
- 输出数据
- 错误信息
- 副作用描述

是否“可以接受”，由认知层判断。

---

### 6. 行动层与行为调制状态的关系

行动层必须遵守当前行为调制状态提供的约束，例如：

- 是否允许自动执行
- 是否需要用户确认
- 是否允许高风险操作
- 是否允许部分完成

行动层**不解析策略含义**，只执行约束。

---

### 7. 行动层与 Runtime 的关系

行动层：

- 不负责调度
- 不管理并发
- 不处理中断逻辑

Runtime 决定：

- 何时执行行动
- 是否暂停或取消
- 是否并行或串行

行动层只响应调用。

---

### 8. 行动层输出定义

行动层向 Runtime / 认知层返回：

- 执行状态（成功 / 失败 / 部分完成）
- 执行结果数据
- 错误或异常信息
- 副作用声明（如已修改外部状态）

该输出不包含：

- 风格化解释
- 风险评估
- 后续策略建议

---

### 9. 与其他模块的关系总结

- **认知 → 行动**：下达“要做什么”
- **控制状态 → 行动**：提供执行边界
- **Runtime → 行动**：决定何时调用
- **行动 → 认知**：反馈执行事实

行动层不与记忆、感官直接交互。

---

### 10. 不可变设计原则（Non-Negotiables）

1. 行动层不做决策
2. 行动层不改目标
3. 行动层不藏失败
4. 行动层不解释结果
5. 行动层必须可替换
6. 行动层必须可审计

---

### 11. 设计状态说明

本设计文档为**概念冻结版本**，用于：

- 对齐工具 / 平台 / 硬件实现团队
- 防止“工具能力反向塑造智能行为”
- 作为 MCP 设计与扩展的上位定义

不涉及具体协议、接口或实现技术。

---

### 12. 一句话定位总结

> **行动层是 agent 最不智能、
> 但最必须绝对可靠的部分。**
