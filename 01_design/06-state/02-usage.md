# Agent State · Usage

## 1. 文档目的

本文件用于说明 **Agent State 在系统中的使用方式**。

它关注的不是 State 是什么，
而是回答一个更具体的问题：

> **系统中的哪些模块会读取 Agent State，
> 以及读取它的目的是什么。**

本文件不定义 State 的结构，
也不描述 State 的生成、更新或演化机制。

---

## 2. 使用原则（总则）

Agent State 在系统中的定位是：

> **全局运行背景（global execution context）**

因此，所有对 State 的使用必须遵循以下基本原则：

- Agent State **只能被读取**
- 读取 State **不会直接产生行为**
- State 提供的是约束与背景，而不是指令

任何模块都不得将 State 视为：

- 控制信号
- 权限来源
- 流程推进条件
- 决策替代品

---

## 3. State 的影响方式

Agent State 的影响是**间接的、软性的**。

它不会回答：

- “要不要做这件事”
- “下一步该做什么”

它只影响：

- **是否现在就做**
- **是否允许并发**
- **是否需要降级、延迟或忽略**
- **以什么强度或成本去做**

这与人体状态的作用方式完全一致。

---

## 4. 各模块对 State 的读取方式

以下内容描述的是 **模块如何“参考” State**，
而不是 State 如何“控制”模块。

---

### 4.1 Cognition 对 State 的使用

Cognition 在进行推理或生成认知结果时，
可以读取 Agent State 作为背景条件。

State 的信息可能被用于：

- 调整推理深度与复杂度
- 控制探索性与保守性
- 决定是否生成完整方案或简化结论
- 判断是否应当推迟复杂认知任务

State **不会**：

- 替代认知判断
- 修改认知结果的语义
- 决定“正确答案是什么”

---

### 4.2 Runtime 对 State 的使用

Runtime 在调度、并发管理与节奏控制时，
会读取 Agent State 作为全局运行约束。

State 的信息可能被用于：

- 限制新任务进入
- 调整任务优先级
- 延迟或合并 Action 的执行
- 在高负载下触发保守调度策略

State **不会**：

- 决定任务的业务逻辑
- 触发流程阶段迁移
- 作为生命周期状态使用

---

### 4.3 Action 对 State 的使用

Action 在实际执行之前，
可以读取 Agent State 作为执行前检查条件。

State 的信息可能被用于：

- 判断是否允许外部副作用
- 选择完整执行或降级执行
- 延迟执行而非立即失败
- 调整执行节奏或资源占用方式

State **不会**：

- 生成 Action
- 改变 Action 的语义目标
- 替代 Action 的授权或校验逻辑

---

## 5. State 的只读性约束（强约束）

为防止系统结构退化，必须明确以下底线：

- 任何模块 **不得因自身执行而假设 State 已发生变化**
- State 的变化 **不是流程推进的副作用**
- 模块执行成功或失败 **不等价于 State 的更新**

State 的存在是系统事实，
而不是模块行为的回执。

---

## 6. 禁止性使用模式（明确否定）

以下使用方式在设计上是**明确禁止的**：

- 使用 State 作为状态机条件
- 使用 State 触发流程迁移
- 使用 State 表示“当前阶段”
- 使用 State 表示“是否完成”
- 使用 State 作为权限或授权来源

一旦 State 被用于上述目的，
它就不再是“整体运行状态”，
而变成了隐形控制系统。

---

## 7. 与流程与生命周期的边界

Agent State 与以下概念 **必须严格分离**：

- Task / Action 生命周期
- Runtime 执行阶段
- Cognition 内部流程
- 任何形式的 Pipeline 或 FSM

State 不描述“事情进行到哪一步”，
只描述：

> **在当前这一步，
> Agent 所处的整体运行条件是什么。**

---

## 8. 设计目标回收

Agent State 的使用设计目标是：

- 为系统提供一致的全局运行背景
- 避免隐式条件散落在各模块内部
- 保持长期演化中的结构清晰性

它像人体状态一样：

- 不发号施令
- 不替人思考
- 却始终影响行为的方式与边界

---

## 9. 小结

Agent State 是：

- 被系统各模块 **同时读取**
- 作为背景条件 **被动影响行为**
- 但**不直接控制任何流程或决策**

只要这一点始终成立，
Agent 就能在复杂度增长的情况下，
保持结构上的一致性与可理解性。
